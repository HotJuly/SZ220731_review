# 组件懒加载
1. 前言

   1. 假设现在具有一个项目,以生产环境打包之后,会得到一个dist文件夹,请问该文件夹中具有几个文件?

      1. index.html文件

      2. main.js文件

      3. 图片处理

         1. 如果图片的的大小小于1MB,那么该图片会以base64格式进行打包,变成一个base64字符串,直接填写在img标签的src属性中

            1. ```html
               <img src="base64://sgdhjagsdhagshjsadhjahsjdkas"
               ```

         2. 如果图片的大小超过1MB,那么该图片就会作为一个文件,单独输出,放在images文件夹中

      4. 如果当前项目中具有10个组件的文件,那么main.js中,就会具有10个组件所有的代码

         1. **问题:用户现在请求官网域名,服务器返回index.html,而html文件中会自动请求main.js文件,用户目前只想观看首页的内容,但是实际上把整个项目中10个组件的代码全部请求过去了**

2. ES6模块化语法

   1. 静态引入
      1. 语法:import Home from '@/components/Home.vue';
      2. 在以生产环境打包的时候,该语法会被源文件的代码替换掉,最终所有的依赖文件全部汇总到了当前项目的入口文件main.js身上,导致main.js中会具有整个项目所有的代码
   2. 动态引入
      1. 语法:import('@/components/Home.vue')
      2. 在以生产环境打包之后,该语法依旧会被保留在js代码,被该语法引入的文件,会被webpack切割为一个单独的文件进行输出
         1. 如果还是前言中说明的情况,所有的组件都用动态引入语法引入,那么现在dist文件中的文件数量,应该是11个
            1. index.html文件
            2. main.js文件(首页代码)
            3. 其余9个组件的代码文件

3. 组件懒加载

   1. 组件懒加载的意思:将一些暂时用不到的组件,延迟他的加载
      1. 让部分组件代码实现异步加载效果
   2. 组件懒加载的优点:
      1. 经过组件懒加载语法之后,用户请求官网域名,服务器会返回index.html文件
      2. index.html文件中,会请求服务器的main.js文件代码
      3. 浏览器得到main.js文件之后,由于其中只有首页的代码,没有其余页面的代码
         1. **所以请求速度更快,代码解析速度也更快,首屏渲染速度也变快,最终首屏白屏时间变短,用户体验提升**
   3. 组件懒加载的缺点:
      1. **由于首屏请求的main.js中,没有其余组件的代码,那么后续切换组件显示的时候,就需要额外发送请求,获取到对应组件的代码,也就是说页面在切换的过程中,会出现短时间的白屏问题**
         1. 注意:并不是每次切换都一定会白屏,只是说第一次切换到没显示过的组件会白屏,后续再次进入就不会白屏,因为浏览器已经缓存了这些显示过的组件的代码

4. 组件预加载

   1. 组件预加载的意思:将组件代码提前请求回来
   2. **优点:其实并没有冲突,在用户请求首页的使用只获取到首页的代码,然后在用户观看首页的过程中,趁着用户不注意,偷偷请求未来可能使用到的组件代码**
   3. **缺点:比较浪费流量**
   4. 原理:其实就是创建script节点,然后在内存中给他添加src属性,让他自动请求服务器的某个js文件
      1. 等需要执行该js文件的时候,再将该script节点插入到页面上即可