# key值

1. key值的使用
   1. 在遍历状态数据,生成多个节点的时候,需要给每个节点都添加上key属性,并输入唯一标识
2. 常用作key值的数据
   1. 遍历得到对象身上的唯一标识,例如:id,vid,uid等
   2. 遍历得到的下标,例如:index
   3. 遍历得到的数据本身,例如链接等
      1. 但是这个写法,数据类型必须是基本数据类型
3. key值的作用
   1. 它与diff算法有关
   2. **当遍历的状态数据发生变化的时候,那么此时Vue会根据最新的数据创建一棵全新的虚拟DOM树,并与旧的虚拟DOM树进行比较,找到可以复用的旧真实DOM节点**
      1. 其中key值就是比较的关键
      2. **first render(首次渲染)**
         1. **获取到模版内容,将模版解析为render函数(这是beforeMount之前做的事情)**
         2. **调用render函数,并将当前最新的数据传入该函数,该函数会返回虚拟DOM**
         3. **根据返回的虚拟DOM,创建对应的真实DOM**
         4. **将创建的真实DOM替换掉页面上指定的el区域**
         5. **最终,GUI线程根据当前最新的html内容,渲染结果到页面上**
      3. **update render(更新渲染)**
         1. **调用render函数,并将当前更新之后的数据传入该函数,该函数会返回全新的虚拟DOM**
         2. **根据全新的虚拟DOM以及旧的虚拟DOM进行比较**
         3. **找到可以复用的真实DOM,进行复用**
         4. **比较结束之后,没有找到可以复用的东西的虚拟DOM,创建全新的真实DOM**
         5. **将得到最新的真实DOM树,替换掉页面上指定区域**
         6. **最终,GUI线程根据当前最新的html内容,渲染结果到页面上**
         7. 其中流程2,3,4就是diff算法
      4. **虚拟DOM比较的注意点:**
         1. **diff算法比较虚拟DOM,都是同级比较,不会递归到后代节点进行比较**
4. 使用下标作为key值,可能会出现的问题?
   1. **input案例**
      1. **diff算法有在比较节点,节点有被复用,但是复用错节点了,导致功能没有实现**
      2. **问题:其实是diff算法的比较规则中,没有考虑到input框的value可能不同原因导致的**
   2. **商品排序案例**
      1. **diff算法有在比较节点,节点没有被复用,本来该案例应该是diff算法最完美的使用场景,但是由于使用下标作为key值,导致所有节点都复用失败,此时diff算法不仅没有优化性能,反而还劣化性能**
5. 如果key值使用唯一标识,有什么好处?
   1. 只要服务器返回的数据与标识之间的关系不变,那么前端的节点就可以一直复用下去

