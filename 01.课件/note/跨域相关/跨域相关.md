#  跨域相关

1. 问题一:什么是跨域

   1. 违反了浏览器的同源策略

   2. 问题:什么是同源?

      1. 两个URL他们的**协议名,域名/主机地址和端口号都相同,就称为同源**

      2. 请求路径的组成部分:协议名+域名/主机地址+端口号+查询字符串

         1. 查询字符串由请求接口地址+请求参数组成

      3. ```javascript
         //例子1:以下两个路径不同源,因为协议名不相同
         http://localhost:8080/home
         ftp://localhost:8080/home

         //例子2:以下两个路径不同源,因为协议名不相同,http和https不是同一种协议
         http://localhost:8080/home
         https://localhost:8080/home

         //例子3:以下两个路径不同源,因为域名不相同
         http://localhost:8080/home
         http://127.0.0.1:8080/home

         //例子4:以下两个路径不同源,因为端口号不同,http协议默认端口号是80
         http://www.baidu.com/home
         http://www.baidu.com:81/home

         //例子5:以下两个路径同源,因为查询字符串不在同源的判断范围之内
         http://www.baidu.com/home
         http://www.baidu.com/about
         ```

         ​

      4. 为什么要有跨域报错?

         1. 假如说现在跨域不报错,那么用户范围了假网站服务器,该服务器返回html网页,在浏览上显示,用户在这个假网页上输入账号密码等操作,假网页会将收集到的数据,发送请求给真网站服务器,真网站服务器将用户相关信息返回给假html网页,最终假html网页将得到的用户数据发送给自家服务器
            1. 这个过程中,用户直接损失了个人的数据,真网站服务器失去了用户的信任,导致互联网环境恶劣,无人在敢使用网页

2. 问题二:跨域一定会报错吗?

   1. 不一定
   2. 服务器之间跨域不报错
   3. script/img/link/video/audio等标签跨域也不报错
   4. **总结:跨域是一种行为,这种行为并不一定会带来后果**

3. 问题三:什么情况下会出现跨域问题

   1. 在浏览器中,发送请求会出现跨域问题
   2. 在发送ajax请求的时候才会出现跨域问题
   3. **总结:跨域问题是浏览器搞的鬼**

4. 问题四:哪些请求算是ajax请求(ajax->async javascript and xml)

   1. 只有使用js中的XHR发送的请求,才是ajax请求

5. 跨域问题解决方案

   1. jsonp
      1. 原理:script标签跨域请求不会报错
      2. 流程:
         1. 前端网页准备好存储数据的变量data和接收数据的函数getData
         2. 前端网页会创建一个script标签,并给script标签添加src属性,用于往跨域服务器发送请求
            1. 请求路径中,会将函数名称getData发送给后端
         3. 后端接收到函数名称之后,会根据函数名称以及想要返回的数据,拼接成为一个全新的文本内容,返回前端
         4. 前端的script标签接收到返回的文本内容之后,当作js代码自动执行
            1. 最终getData函数在前端调用,并将得到的数据存入data变量中
      3. 优点:
         1. 上线之后,依旧可以使用
      4. 缺点:
         1. 前后端都需要做一些特殊的处理才能实现,很麻烦
   2. CORS
      1. 原理:跨域问题是浏览器搞的鬼,只要服务器告诉浏览器愿意被当前网页请求即可
      2. 配置:
         1. 服务器在响应头中,进行特殊配置
   3. proxy


